# klipper
[include mainsail.cfg]                  # Include configuration from mainsail.cfg file
[include Macros.cfg]
[include KAMP_Settings.cfg]

[virtual_sdcard]
path: /home/biqu/printer_data/gcodes    # Path to the virtual SD card directory
on_error_gcode: CANCEL_PRINT            # G-code to execute on error (defined in CANCEL_PRINT macro)

[gcode_arcs]
resolution: 0.1                         # Arc interpolation resolution, handles G2/G3 commands

[exclude_object]                        # Exclude object for cancellation

[force_move]
enable_force_move: true                 # Enable force move feature

#####################################################################
##	                 EBB SB2209(RP2040) Config
#####################################################################
[mcu EBBCan]
canbus_uuid: 33017fa4bf7d              # Unique identifier for the CAN bus interface c9d55fbf221e
# Acceleration sensor on cartographer sensor is recommended, 
# so the configuration of EBB is commented
#[adxl345]
#cs_pin: EBBCan:gpio1                   # Chip select pin
#spi_software_sclk_pin: EBBCan:gpio2    # SPI clock pin
#spi_software_mosi_pin: EBBCan:gpio0    # SPI master out slave in pin
#spi_software_miso_pin: EBBCan:gpio3    # SPI master in slave out pin
#axes_map: z,-y,x                       # Axis mapping settings
##SHAPER_CALIBRATE

#[resonance_tester]                     # Resonance tester configuration
#probe_points: 175, 175, 20             # Probe point positions
#accel_chip: adxl345                    # Acceleration chip used

[mcu]                                   # Main MCU configuration
#serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_slipper-if00  # Serial port setting, this line is commented out
canbus_uuid: c9d55fbf221e               # CAN bus UUID 33017fa4bf7d
canbus_interface: can0                  # CAN bus interface

#####################################################################
##	                 Temperature Monitoring
#####################################################################
[temperature_sensor EBB_NTC]            # EBB_NTC temperature sensor configuration
sensor_type: Generic 3950               # Sensor type
sensor_pin: EBBCan:gpio28               # Sensor pin

[temperature_sensor BTT-MCU]            # BTT-MCU temperature sensor configuration       
sensor_type: temperature_mcu            # Sensor type

[temperature_sensor SOC]                # BTT-PI temperature sensor configuration
sensor_type: temperature_host           # Sensor type

#####################################################################
##                     Model and Acceleration
#####################################################################
[printer]                             # Printer configuration
kinematics: corexy                    # Printer type: corexy
max_velocity: 600                    # Maximum velocity (max 300)
max_accel: 10000                       # Maximum acceleration (max 4000)
max_z_velocity: 50                    # Maximum Z-axis velocity
max_z_accel: 100                      # Maximum Z-axis acceleration
minimum_cruise_ratio: 0.5             # Default 0.5
square_corner_velocity: 25            # Square corner velocity

#####################################################################
##                            X Axis
#####################################################################

[stepper_x]
step_pin: PE6                         # X-axis motor pulse pin setting
dir_pin: !PE5                         # X-axis motor direction pin setting
enable_pin: !PC14                     # X-axis motor enable pin setting
microsteps: 32                        # Motor microsteps setting
rotation_distance: 40                 # Active pulley circumference mm (2GT-20T pulley 40, 2GT-16T pulley 32)
full_steps_per_rotation: 200          # Number of pulses required for a single motor revolution (1.8 degree motor: 200, 0.9 degree motor: 400)
endstop_pin: EBBCan:gpio24            # Limit switch PIN setting (X-)
position_min: 0                       # X-axis minimum travel - software limit
position_endstop: 350                 # Mechanical reset point coordinates for X-axis
position_max: 350                     # X-axis maximum travel - software limit
homing_speed: 150                     # Homing speed maximum 100
homing_retract_dist: 5                # Setback distance after the first trigger of the homing switch
homing_positive_dir: true             # Direction of homing (generally no change required)

[tmc5160 stepper_x]
cs_pin: PC13                          # Chip select pin
spi_software_sclk_pin: PG8            # SPI clock pin
spi_software_mosi_pin: PG6            # SPI master out slave in pin
spi_software_miso_pin: PG7            # SPI master in slave out pin
driver_TPFD: 0                        # Driver setting
run_current: 1.5                      # Running current
spi_speed: 3500000                    # SPI speed
interpolate: True                     # Interpolation


[stepper_x1]
step_pin: PD4                         # X1-axis motor pulse pin setting
dir_pin: !PD3                         # X1-axis motor direction pin setting
enable_pin: !PD6                      # X1-axis motor enable pin setting
microsteps: 32                        # Motor microsteps setting
rotation_distance: 40                 # Active pulley circumference mm (2GT-20T pulley 40, 2GT-16T pulley 32)
full_steps_per_rotation: 200          # Number of pulses required for a single motor revolution (1.8 degree motor: 200, 0.9 degree motor: 400)

[tmc5160 stepper_x1]
cs_pin: PD5                           # Chip select pin
spi_software_sclk_pin: PG8            # SPI clock pin
spi_software_mosi_pin: PG6            # SPI master out slave in pin
spi_software_miso_pin: PG7            # SPI master in slave out pin
driver_TPFD: 0                        # Driver setting
run_current: 1.5                      # Running current
spi_speed: 3500000                    # SPI speed
interpolate: True                     # Interpolation

#####################################################################
##                           Y Axis
#####################################################################

[stepper_y]
step_pin: PC7                         # Y-axis motor pulse pin setting
dir_pin: !PC8                         # Y-axis motor direction pin setting
enable_pin: !PD2                      # Y-axis motor enable pin setting
microsteps: 32                        # Motor microsteps setting
rotation_distance: 40                 # Active pulley circumference mm (2GT-20T pulley 40, 2GT-16T pulley 32)
full_steps_per_rotation: 200          # Number of pulses required for a single motor revolution (1.8 degree motor: 200, 0.9 degree motor: 400)
endstop_pin: PF2                      # Limit switch PIN setting (Y-)
position_min: 0                       # Y-axis minimum travel - software limit
position_endstop: 360               # Mechanical reset point coordinates for Y-axis (change to 350 for 350 models)
position_max: 360                   # Y-axis maximum travel - software limit (change to 350 for 350 models)
homing_speed: 150                     # Homing speed maximum 100
homing_retract_dist: 5                # Setback distance after the first trigger of the homing switch
homing_positive_dir: true             # Direction of homing (generally no change required)

[tmc5160 stepper_y]
cs_pin: PC6                           # Chip select pin
spi_software_sclk_pin: PG8            # SPI clock pin
spi_software_mosi_pin: PG6            # SPI master out slave in pin
spi_software_miso_pin: PG7            # SPI master in slave out pin
driver_TPFD: 0                        # Driver setting
run_current: 1.5                      # Running current
spi_speed: 3500000                    # SPI speed
interpolate: True                     # Interpolation

[stepper_y1]
step_pin: PE2                         # Y1-axis motor pulse pin setting
dir_pin: !PE1                         # Y1-axis motor direction pin setting
enable_pin: !PE4                      # Y1-axis motor enable pin setting
microsteps: 32                        # Motor microsteps setting
rotation_distance: 40                 # Active pulley circumference mm (2GT-20T pulley 40, 2GT-16T pulley 32)
full_steps_per_rotation: 200          # Number of pulses required for a single motor revolution (1.8 degree motor: 200, 0.9 degree motor: 400)

[tmc5160 stepper_y1]
cs_pin: PE3                           # Chip select pin
spi_software_sclk_pin: PG8            # SPI clock pin
spi_software_mosi_pin: PG6            # SPI master out slave in pin
spi_software_miso_pin: PG7            # SPI master in slave out pin
driver_TPFD: 0                        # Driver setting
run_current: 1.5                      # Running current
spi_speed: 3500000                    # SPI speed
interpolate: True                     # Interpolation


#####################################################################
#    -------z1------- 
#   |                 |
#   |                 |
#   |                 |
#   |                 |
#   |                 |
#   |                 |
#  z0---   display ---z2
#####################################################################
##                  Z0 Axis
#####################################################################
[stepper_z]
step_pin: PB8                         # Z0-axis motor pulse pin setting
dir_pin: !PB7                         # Z0-axis motor direction pin setting
enable_pin: !PE0                      # Z0-axis motor enable pin setting
microsteps: 16                        # Motor microsteps setting
rotation_distance: 4                  # Active pulley circumference mm
endstop_pin: probe:z_virtual_endstop  # Limit switch PIN setting (Z0-)
position_max: 235                     # Z0-axis maximum travel - software limit
position_min: -5.0                    # Z0-axis minimum travel - software limit
homing_speed: 20                      # Homing speed
homing_retract_dist: 0                # Setback distance after the first trigger of the homing switch
homing_positive_dir: False            # Direction of homing (generally no change required)

#--------------------------------------------------------------------
[tmc2209 stepper_z]                   # TMC2209 driver settings
uart_pin: PB9                         # Driver communication port
interpolate: true                     # Enable 256 microstep interpolation
run_current: 0.8                      # Motor running current (mA)
hold_current: 0.8                     # Holding current (mA)

#--------------------------------------------------------------------
[stepper_z1]
step_pin: PB4                         # Z1-axis motor pulse pin setting
dir_pin: !PB3                         # Z1-axis motor direction pin setting
enable_pin: !PB6                      # Z1-axis motor enable pin setting
microsteps: 16                        # Motor microsteps setting
rotation_distance: 4                  # Active pulley circumference mm

#--------------------------------------------------------------------
[tmc2209 stepper_z1]                  # TMC2209 driver settings
uart_pin: PB5                         # Driver communication port
interpolate: true                     # Enable 256 microstep interpolation
run_current: 0.8                      # Motor running current (mA)
hold_current: 0.8                     # Holding current (mA)

#--------------------------------------------------------------------
[stepper_z2]
step_pin: PG13                        # Z2-axis motor pulse pin setting
dir_pin: !PG12                        # Z2-axis motor direction pin setting
enable_pin: !PG15                     # Z2-axis motor enable pin setting
microsteps: 16                        # Motor microsteps setting
rotation_distance: 4                  # Active pulley circumference mm

#--------------------------------------------------------------------
[tmc2209 stepper_z2]                  # TMC2209 driver settings
uart_pin: PG14                        # Driver communication port
interpolate: true                     # Enable 256 microstep interpolation
run_current: 0.8                      # Motor running current (mA)
hold_current: 0.8                     # Holding current (mA)

#####################################################################
##                  Extruder Motor
#####################################################################

[extruder]
step_pin: EBBCan:gpio18              # Step pin
dir_pin: EBBCan:gpio19               # Direction pin, "!" indicates logic inversion
enable_pin: !EBBCan:gpio17           # Enable pin, "!" indicates logic inversion
full_steps_per_rotation: 200         # Number of pulses required for a single motor revolution (1.8 degree motor: 200, 0.9 degree motor: 400)
microsteps: 16                       # Microsteps setting
## When calibrating the extruder, update the following value
## Assume you request 100mm feed but get 98mm,
## New value = old value x (actual extruded length / target length)
## 22.6789511 is our recommended value
gear_ratio: 50:10                    # Gear ratio
rotation_distance: 22.08784592       # Rotation distance
nozzle_diameter: 0.400               # Nozzle diameter
filament_diameter: 1.750             # Filament diameter
heater_pin: EBBCan:gpio7             # Heater pin
#control: pid                         # Control method
#pid_Kp: 24.328                       # Proportional parameter of the PID controller
#pid_Ki: 1.908                        # Integral parameter of the PID controller
#pid_Kd: 77.543                       # Derivative parameter of the PID controller
min_temp: -20                        # Minimum temperature
max_temp: 350                        # Maximum temperature
min_extrude_temp: 170                # Minimum extrude temperature
pressure_advance: 0.05               # Pressure advance - try to keep pressure below 1.0
pressure_advance_smooth_time: 0.040   # Pressure advance smooth time - default is 0.040
## Nozzle temperature PID calibration command: "PID_CALIBRATE HEATER=extruder TARGET=245"
sensor_type: MAX31865                # Temperature sensor type
sensor_pin: EBBCan:gpio9             # Sensor pin
spi_software_sclk_pin: EBBCan:gpio10 # SPI clock pin
spi_software_mosi_pin: EBBCan:gpio8  # SPI master out slave in pin
spi_software_miso_pin: EBBCan:gpio11 # SPI master in slave out pin
rtd_nominal_r: 100                   # RTD nominal resistance
rtd_reference_r: 430                 # RTD reference resistance
rtd_num_of_wires: 2                  # Number of wires for the RTD
max_extrude_only_distance: 101

[tmc2209 extruder]
uart_pin: EBBCan:gpio20              # UART communication pin
interpolate: true                    # Enable 256 microstep interpolation
run_current: 0.60                    # Running current

#--------------------------------------------------------------------
[verify_heater extruder]             # Heater block temperature tolerance configuration
max_error: 120                       # Maximum error
check_gain_time: 120                 # Tolerance time
hysteresis: 50                       # Tolerance temperature
heating_gain: 2                      # Heating gain

#####################################################################
##                  Heated Bed
#####################################################################
[heater_bed]
heater_pin: PA1                        # (BE0) Heater pin
sensor_pin: PB1                        # Sensor interface (TB) sensor pin
sensor_type: ATC Semitec 104GT-2       # ATC Semitec 104GT-2 temperature sensor type
#control: pid                           # Control method
## Heated bed temperature PID calibration command: "PID_CALIBRATE HEATER=heater_bed TARGET=100"
#pid_kp: 53.467                         # PID Kp value
#pid_ki: 0.931                          # PID Ki value
#pid_kd: 767.921                        # PID Kd value
min_temp: -20                          # Minimum temperature
max_temp: 135                          # Maximum temperature
max_power: 1.0                         # Maximum power

#####################################################################
##                          Idle Timeout for Heated Bed
#####################################################################

[idle_timeout]
timeout: 1800                # Turn off heated bed if idle for more than 30 minutes

#####################################################################
# 	                 Cartographer V3 （ADXL345）
#####################################################################

[mcu cartographer]
canbus_uuid: c9c968d95c80

[cartographer]
mcu: cartographer
#    Fill in the UUID that was just recorded           
x_offset: 0                          
#    adjust for your cartographers offset from nozzle to middle of coil
y_offset: 23                         
#    adjust for your cartographers offset from nozzle to middle of coil
verbose: yes

[adxl345]
cs_pin: cartographer:PA3
spi_bus: spi1

[resonance_tester]
accel_chip: adxl345             # Specifies ADXL345 accelerometer for resonance testing
probe_points:
    175, 175, 20                # Coordinates of the probe points for resonance testing


#####################################################################
##                  Bed Mesh Calibration
#####################################################################
[bed_mesh]
zero_reference_position: 175,175  
#    This option is suitable for the 350 model. 
#    set this to the middle of your bed
speed: 300
#    movement speed of toolhead during bed mesh
horizontal_move_z: 3
#    height of scanner during bed mesh scan
mesh_min: 30, 30
#    start point of bed mesh [X, Y]
mesh_max: 320, 320
#    end point of bed mesh [X, Y]
probe_count: 30, 30
adaptive_margin: 10
algorithm: bicubic
#####################################################################
##                  Fans
#####################################################################

[heater_fan hotend_fan]          # Hotend fan
pin: EBBCan:gpio14               # Hotend fan pin
heater: extruder                 # Associated heating device
heater_temp: 50.0                # Temperature to start the fan
cycle_time: 0.00003                 # Cycle time

#--------------------------------------------------------------------

[heater_fan Skirt_fan]            # Skirt fan 
pin: PF9                         # FAN-2
cycle_time: 0.00003              # Cycle time
shutdown_speed: 0.0              # Closing speed (Please do not change)
kick_start_time: 0.5             # start-up time (Please do not change)
heater: heater_bed               # Related equipment: heater_bed
heater_temp: 50                  # How many degrees does the heat bed reach to activate the fan
fan_speed: 0.5                   # Fan speed

#--------------------------------------------------------------------

[controller_fan driver_fan]      # Driver cooling fan
pin: PF6                         # Fan pin 
cycle_time: 0.00003                  # Cycle time
max_power: 1.0                   # Maximum power
shutdown_speed: 0.0              # Shutdown speed
fan_speed: 0.8                   # Fan speed when heater or stepper driver is active (0.0 to 1.0). Default is 1.0.
idle_timeout: 90                 # Time in seconds to keep the fan running after the stepper driver or heater is no longer active. Default is 30 seconds.
idle_speed: 0.4                  # Fan speed after the stepper driver is no longer active and before idle_timeout is reached (0.0 to 1.0). Default is fan_speed.
stepper: stepper_x               # Active motors
#Define the name of the heater/stepper configuration section associated with this fan. 
#If a comma-separated list of heater/stepper names is provided here, the fan will be enabled when any of the given heaters/steppers are enabled.
#The default heater is "extruder", and the default stepper is all steppers.

#--------------------------------------------------------------------

#Note: The following FAN0/FAN1/FAN2 settings are only applicable when using OrcaSlicer,
#as only OrcaSlicer allows for the additional configuration of parts cooling fans and filter fans. 
#If you use other slicing software, please comment out the following configurations.
# instead of using [fan], we define the default part cooling fan with [fan_generic] here
# this is the default part cooling fan

[fan_generic fan0]               # 5015 Part cooling Blower 
pin: EBBCan:gpio13               # Fan pin 
cycle_time: 0.00003                  # Cycle time
hardware_pwm: false              # hardware pwm

#--------------------------------------------------------------------

[fan_generic fan2]               # 12032 Auxiliary Part cooling Blower 
pin: PA0                         # Fan pin
cycle_time: 0.00003              # Cycle time
hardware_pwm: false              # hardware pwm
kick_start_time: 0.5             # start-up time (Please do not change)

#--------------------------------------------------------------------

[fan_generic fan3]               # Fume_Pack Exhaust Fan
pin: PF7                         # Fan pin     
cycle_time: 0.00003                 # Cycle time
hardware_pwm: false               # hardware pwm
kick_start_time: 0.5             # start-up time (Please do not change)

#--------------------------------------------------------------------

[gcode_macro M106]
gcode:
    {% set fan = 'fan' + (params.P|int if params.P is defined else 0)|string %}
    {% set speed = (params.S|float / 255 if params.S is defined else 1.0) %}
    SET_FAN_SPEED FAN={fan} SPEED={speed}

#####################################################################
##                            RGB-LED Lights
#####################################################################

[neopixel hotend_rgb]
pin: EBBCan:gpio16            # LED pin
chain_count: 3                # Number of LEDs
color_order: GRBW             # Color order
initial_RED: 0.2              # Initial red brightness
initial_GREEN: 0.2            # Initial green brightness
initial_BLUE: 0.2             # Initial blue brightness

[neopixel my_neopixel]
pin: PD15                     # Signal interface
chain_count: 50               # Number of LEDs
color_order: GRB              # Color order
initial_RED: 0.2              # Initial red brightness
initial_GREEN: 0.2            # Initial green brightness
initial_BLUE: 0.2             # Initial blue brightness

[gcode_macro STOP_LED]
gcode:
    STOP_LED_EFFECTS

[gcode_macro STOP_LED]
gcode:
    STOP_LED_EFFECTS

[gcode_macro Rainbow_LED]
gcode:
    SET_LED_EFFECT EFFECT=rainbow

[led_effect rainbow] 
leds:    
  neopixel:my_neopixel
layers:
  gradient 0.50 0.50 top (1,0,0),(0,1,0),(0,0,1) 
frame_rate: 10

[led_effect extruder_temp]
leds:
    neopixel:my_neopixel
layers:
    heater 0.50 0.50 top (0.0,1.0,0.0),(1.0,0.0,0.0),(0.0,0.0,1.0)
frame_rate: 10
heater: extruder
autostart: true

[led_effect bed_heating]
leds:
    neopixel:my_neopixel
layers:
    heater 0.50 0.50 top (0.0,1.0,0.0),(1.0,0.0,0.0),(0.0,0.0,1.0)
frame_rate: 10
heater: heater_bed
autostart: true

[led_effect progress_bar]
leds:
    neopixel:my_neopixel
autostart: true
frame_rate:                         10
layers:
    progress  -1  0 add         ( 0, 0,   1),( 0, 0.1, 0.6)
    static     0  0 top         ( 0, 0, 0.1)


####################################################################################
##                                    Homing Override
####################################################################################
[homing_override]
axes: z                    # Override homing for the Z axis only
set_position_z: 0           # Set the Z position to 0 after homing
gcode:
    G90                     # Set to absolute positioning mode
    G0 Z10 F1200            # Move Z axis to 10mm above the bed at 1200 mm/min
    G28 Y                   # Home Y axis
    G28 X                   # Home X axis
    G1 X175 Y175 F7200      # Move to a specific coordinate (125, 125) at 7200 mm/min
    G28 Z                   # Home Z axis again

####################################################################################
##                                    Z Tilt Adjustment
####################################################################################
[z_tilt]
##  Use Z_TILT_ADJUST to level the bed.
##  z_positions: Location of toolhead
z_positions:
   -50, 18
   175, 398
   400, 18
points:
   50, 50
   175, 300
   300, 50
##--------------------------------------------------------------------

speed: 300                 # Speed of Z tilt adjustment
horizontal_move_z: 2       # Z axis move speed for adjustments
retries: 10                # Number of retries for adjustment points
retry_tolerance: 0.0075    # Retry tolerance for adjustment accuracy

####################################################################################
####################################################################################
[gcode_macro Z_TILT_ADJUST]     # IDM/Cartographer optimized 3Z leveling macro
rename_existing: _Z_TILT_ADJUST
gcode:
    SAVE_GCODE_STATE NAME=STATE_Z_TILT         # Save current state for Z tilt adjustment
    BED_MESH_CLEAR                             # Clear bed mesh
    {% if not printer.z_tilt.applied %}
      _Z_TILT_ADJUST horizontal_move_z=10 retry_tolerance=1   # Adjust Z tilt with higher tolerance initially
    {% endif %}
    _Z_TILT_ADJUST horizontal_move_z=2          # Fine-tune Z tilt adjustment
    RESTORE_GCODE_STATE NAME=STATE_Z_TILT       # Restore saved state after adjustment

[gcode_macro LOAD_FILAMENT]
variable_load_distance:  50
variable_purge_distance:  25
gcode:
    {% set speed = params.SPEED|default(300) %}
    {% set max_velocity = printer.configfile.settings['extruder'].max_extrude_only_velocity  * 60 %}
    SAVE_GCODE_STATE NAME=load_state
    G91
    G92 E0
    G1 E{load_distance} F{max_velocity} # fast-load
    G1 E{purge_distance} F{speed} # purge
    RESTORE_GCODE_STATE NAME=load_state

[gcode_macro UNLOAD_FILAMENT]
variable_unload_distance:  50
variable_purge_distance:  25
gcode:
    {% set speed = params.SPEED|default(300) %}
    {% set max_velocity = printer.configfile.settings['extruder'].max_extrude_only_velocity  * 60 %}
    SAVE_GCODE_STATE NAME=unload_state
    G91
    G92 E0
    G1 E{purge_distance} F{speed} # purge
    G1 E-{unload_distance} F{max_velocity} # fast-unload
    RESTORE_GCODE_STATE NAME=unload_state

####################################################################################
##                               Probe Calibration Macro
####################################################################################
[gcode_macro PROBECALIBRATE]
# Defines a G-code macro for probe calibration
gcode:
    G28                          # Home all axes
    G0 X175 Y175 Z1 F3600        # Fast move to X150 Y150 Z1 at 3600 mm/min
    PROBE_CALIBRATE              # Start probe calibration

####################################################################################
##                               Bed Leveling and Height Calibration Macro
####################################################################################
[gcode_macro G32]
# Defines a G-code macro for bed leveling and height calibration
gcode:
    BED_MESH_CLEAR               # Clear bed mesh
    G28                          # Home all axes
    Z_TILT_ADJUST                # Perform gantry leveling
    G28                          # Home all axes
    G0 X175 Y175 Z30 F3600       # Fast move to X150 Y150 Z30 at 3600 mm/min

#--------------------------------------------------------------------
[gcode_macro DRAW_LINES]
gcode:
    G90                           # Absolute positioning
    # G92 E0                      # Reset Extruder (commented out for now)
    # G1 Z5.0  F7200              # Move Z Axis up (commented out for now)
    G1 X50  Y0         F7200      # Move to start position
    M83                           # Set extruder to relative mode
    G1 E15 F400                   # Extrude filament
    G1 Z0.28 F7200                # Lower Z axis
    G1 X200 Y0   Z0.28 F1200 E17  # Draw the first line
    G1 X200 Y0.4 Z0.28 F2400      # Move to side a little
    G1 X55  Y0.4 Z0.28 F1200 E34  # Draw the second line
    G92 E0                        # Reset Extruder
    G90                           # Return to absolute positioning

[gcode_macro PRINT_START]
gcode:
  {% set target_bed = params.BED|int %}                  # Target bed temperature
  {% set target_extruder = params.EXTRUDER|int %}        # Target nozzle temperature
  {% set x_wait = printer.toolhead.axis_maximum.x|float / 2 %}  # Bed center X
  {% set y_wait = printer.toolhead.axis_maximum.y|float / 2 %}  # Bed center Y

  SET_GCODE_OFFSET Z=0                                   # Reset Z offset
  G28                                                    # Home all axes
  G90                                                    # Set to absolute positioning

  SET_DISPLAY_TEXT MSG="Heating Bed: {target_bed}°C"     # Display bed heating message
  G1 X{x_wait} Y{y_wait} Z15 F9000                       # Move to bed center
  M190 S{target_bed}                                     # Wait for bed to reach target temperature

  SET_DISPLAY_TEXT MSG="Leveling..."                    # Display leveling message
  Z_TILT_ADJUST                                          # Perform Z tilt adjustment
  G28 Z                                                  # Re-home Z after adjustment

  SET_DISPLAY_TEXT MSG="Bed Mesh Calibration"            # Display mesh calibration message
  BED_MESH_CALIBRATE                                     # Perform bed mesh calibration

  SET_DISPLAY_TEXT MSG="Calibrating Z Offset"            # Display Z offset calibration message
  CARTOGRAPHER_TOUCH_HOME                                     # Calibrate Z offset

  SET_DISPLAY_TEXT MSG="Heating Nozzle: {target_extruder}°C" # Display nozzle heating message
  G1 X{x_wait} Y{y_wait} Z15 F9000                       # Move to bed center
  M109 S{target_extruder}                                # Heat nozzle to target temperature

  SET_DISPLAY_TEXT MSG="Preparing to Print..."           # Display preparation message
  G0 X{x_wait - 50} Y4 F10000                            # Move to primeline start point
  G0 Z0.4                                                # Raise Z to 0.4mm
  G91                                                    # Switch to relative positioning
  G1 X100 E20 F1000                                      # Extrude primeline
  G90                                                    # Switch back to absolute positioning

#--------------------------------------------------------------------
[gcode_macro PRINT_END]
gcode:
    {% set th = printer.toolhead %}
    {% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
    {% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
    {% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
    
    SAVE_GCODE_STATE NAME=STATE_PRINT_END

    M400                           ; wait for buffer to clear
    G92 E0                         ; zero the extruder
    G1 E-20.0 F3600                 ; retract filament
    
    TURN_OFF_HEATERS
    
    G90                                      ; absolute positioning
    G0 X{x_safe} Y{y_safe} Z{z_safe} F20000  ; move nozzle to remove stringing
    G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600  ; park nozzle at rear
    M107                                     ; turn off fan
    SET_FAN_SPEED FAN=fan0 SPEED=0
    SET_FAN_SPEED FAN=fan2 SPEED=0
    SET_FAN_SPEED FAN=fan3 SPEED=0

    
    BED_MESH_CLEAR

    # The purpose of the SAVE_GCODE_STATE/RESTORE_GCODE_STATE
    # command pair is to restore the printer's coordinate system
    # and speed settings since the commands above change them.
    # However, to prevent any accidental, unintentional toolhead
    # moves when restoring the state, explicitly set MOVE=0.
    RESTORE_GCODE_STATE NAME=STATE_PRINT_END MOVE=0
#--------------------------------------------------------------------
[gcode_macro PAUSE]
description: Pause the actual running print
rename_existing: PAUSE_BASE
# change this if you need more or less extrusion
variable_extrude: 1.0
gcode:
  ##### read E from pause macro #####
  {% set E = printer["gcode_macro PAUSE"].extrude|float %}
  ##### set park positon for x and y #####
  # default is your max posion from your printer.cfg
  {% set x_park = printer.toolhead.axis_maximum.x|float - 5.0 %}
  {% set y_park = printer.toolhead.axis_maximum.y|float - 5.0 %}
  ##### calculate save lift position #####
  {% set max_z = printer.toolhead.axis_maximum.z|float %}
  {% set act_z = printer.toolhead.position.z|float %}
  {% if act_z < (max_z - 2.0) %}
      {% set z_safe = 2.0 %}
  {% else %}
      {% set z_safe = max_z - act_z %}
  {% endif %}
  ##### end of definitions #####
  PAUSE_BASE
  G91
  {% if printer.extruder.can_extrude|lower == 'true' %}
    G1 E-{E} F2100
  {% else %}
    {action_respond_info("Extruder not hot enough")}
  {% endif %}
  {% if "xyz" in printer.toolhead.homed_axes %}
    G1 Z{z_safe} F900
    G90
    G1 X{x_park} Y{y_park} F6000
  {% else %}
    {action_respond_info("Printer not homed")}
  {% endif %} 
#--------------------------------------------------------------------
[gcode_macro RESUME]
description: Resume the actual running print
rename_existing: RESUME_BASE
gcode:
  ##### read E from pause macro #####
  {% set E = printer["gcode_macro PAUSE"].extrude|float %}
  #### get VELOCITY parameter if specified ####
  {% if 'VELOCITY' in params|upper %}
    {% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
  {%else %}
    {% set get_params = "" %}
  {% endif %}
  ##### end of definitions #####
  {% if printer.extruder.can_extrude|lower == 'true' %}
    G91
    G1 E{E} F2100
  {% else %}
    {action_respond_info("Extruder not hot enough")}
  {% endif %}  
  RESUME_BASE {get_params}
#--------------------------------------------------------------------

[gcode_macro CANCEL_PRINT]
# Defines a G-code macro to cancel the actual running print
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
variable_park = True
gcode = 
    G28 Y                                     # Home Y axis
    _TOOLHEAD_PARK_PAUSE_CANCEL               # Call _TOOLHEAD_PARK_PAUSE_CANCEL macro
    TURN_OFF_HEATERS                          # Turn off all heaters
    CANCEL_PRINT_BASE                         # Call CANCEL_PRINT_BASE to cancel print
    SET_FAN_SPEED FAN=fan0 SPEED=0
    SET_FAN_SPEED FAN=fan2 SPEED=0
    SET_FAN_SPEED FAN=fan3 SPEED=0


[gcode_macro DATA_SAMPLE]
gcode:
  G90
  M106 S255
  RESPOND TYPE=command MSG='Waiting for Coil to cool to 40'
  M117 Waiting for Coil to cool to 40
  TEMPERATURE_WAIT SENSOR='temperature_sensor cartographer_coil' MAXIMUM=40
  RESPOND TYPE=command MSG='Starting Phase 1 of 4'
  M117 Starting Phase 1 of 4
  M106 S0
  G28
  G0 Z1
  M104 S250
  M140 S110
  G4 P1000
  CARTOGRAPHER_STREAM FILENAME=data1
  M117 Waiting for Coil to heat to 70
  RESPOND TYPE=command MSG='Waiting for Coil to heat to 70'
  TEMPERATURE_WAIT SENSOR='temperature_sensor cartographer_coil' MINIMUM=55
  CARTOGRAPHER_STREAM FILENAME=data1
  M104 S0
  M140 S0
  M106 S255
  G0 Z80
  RESPOND TYPE=command MSG='Waiting for Coil to cool to 40'
  M117 Waiting for Coil to cool to 40
  TEMPERATURE_WAIT SENSOR='temperature_sensor cartographer_coil' MAXIMUM=40

  M117 Starting Phase 2 of 4
  RESPOND TYPE=command MSG='Starting Phase 2 of 4'
  M106 S0
  G28 Z0
  G0 Z2
  M104 S250
  M140 S110
  G4 P1000
  CARTOGRAPHER_STREAM FILENAME=data2
  M117 Waiting for Coil to heat to 70
  RESPOND TYPE=command MSG='Waiting for Coil to heat to 70'
  TEMPERATURE_WAIT SENSOR='temperature_sensor cartographer_coil' MINIMUM=55
  CARTOGRAPHER_STREAM FILENAME=data2
  M104 S0
  M140 S0
  M106 S255
  G0 Z80
  RESPOND TYPE=command MSG='Waiting for Coil to cool to 40'
  M117 Waiting for Coil to cool to 40
  TEMPERATURE_WAIT SENSOR='temperature_sensor cartographer_coil' MAXIMUM=40

  M117 "Starting Phase 3 of 4"
  RESPOND TYPE=command MSG='Starting Phase 3 of 4'
  M106 S0
  G28 Z0
  G0 Z3
  M104 S250
  M140 S110
  G4 P1000
  CARTOGRAPHER_STREAM FILENAME=data3
  M117 Waiting for Coil to heat to 70
  RESPOND TYPE=command MSG='Waiting for Coil to heat to 70'
  TEMPERATURE_WAIT SENSOR='temperature_sensor cartographer_coil' MINIMUM=55
  CARTOGRAPHER_STREAM FILENAME=data3
  M104 S0
  M140 S0
  M106 S255
  G0 Z80
  M117 Waiting for Coil to cool to 40
  RESPOND TYPE=command MSG='Waiting for Coil to cool to 40'
  TEMPERATURE_WAIT SENSOR='temperature_sensor cartographer_coil' MAXIMUM=40

  M117 "Starting Phase 4 of 4"
  RESPOND TYPE=command MSG='Starting Phase 4 of 4'
  M106 S0
  G28 Z0
  G0 Z5
  M104 S250
  M140 S110
  G4 P1000
  CARTOGRAPHER_STREAM FILENAME=data4
  M117 Waiting for Coil to heat to 70
  RESPOND TYPE=command MSG='Waiting for Coil to heat to 70'
  TEMPERATURE_WAIT SENSOR='temperature_sensor cartographer_coil' MINIMUM=55
  CARTOGRAPHER_STREAM FILENAME=data4
  M104 S0
  M140 S0
  RESPOND TYPE=command MSG='Testing complete, please move files using: mv ~/klipper/data1 ~/klipper/data2 ~/klipper/data3 ~/klipper/data4 ~/cartographer-klipper/'
  M117 "Testing complete, please move files using: mv ~/klipper/data1 ~/klipper/data2 ~/klipper/data3 ~/klipper/data4 ~/cartographer-klipper/"
  RESPOND TYPE=command MSG='Follow the remaining instructions here: https://docs.cartographer3d.com/cartographer-probe/advanced-features/temperature-differential-calibration-beta'
  M117 "Follow the remaining instructions here: https://docs.cartographer3d.com/cartographer-probe/advanced-features/temperature-differential-calibration-beta"

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 65.219
#*# pid_ki = 3.397
#*# pid_kd = 313.052
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 30.081
#*# pid_ki = 10.028
#*# pid_kd = 22.560
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.049562, 0.047981, 0.049603, 0.047357, 0.045599, 0.037046, 0.028675, 0.026692, 0.024490, 0.024431, 0.029057, 0.029801, 0.025201, 0.022653, 0.022761, 0.025122, 0.024925, 0.030878, 0.030894, 0.026489, 0.024306, 0.023495, 0.023414, 0.024351, 0.024951, 0.026550, 0.029446, 0.029361, 0.027597, 0.025853
#*# 	0.054108, 0.051636, 0.051099, 0.047361, 0.044577, 0.035199, 0.030187, 0.032473, 0.027383, 0.024649, 0.030008, 0.029722, 0.028710, 0.025555, 0.024996, 0.025501, 0.025245, 0.029021, 0.029128, 0.025684, 0.025742, 0.028082, 0.026689, 0.029269, 0.030580, 0.032267, 0.034886, 0.035574, 0.035620, 0.033003
#*# 	0.052278, 0.051408, 0.046691, 0.044311, 0.039477, 0.029283, 0.029240, 0.041735, 0.032201, 0.021318, 0.026059, 0.027879, 0.027286, 0.024005, 0.023259, 0.023984, 0.022912, 0.024311, 0.026210, 0.025223, 0.027290, 0.028998, 0.028812, 0.031773, 0.032816, 0.034822, 0.039561, 0.041360, 0.041780, 0.039192
#*# 	0.047502, 0.043221, 0.042955, 0.041268, 0.034149, 0.020413, 0.022329, 0.033922, 0.025813, 0.017168, 0.021138, 0.023637, 0.023496, 0.020354, 0.020853, 0.020119, 0.016744, 0.019611, 0.022078, 0.023504, 0.024272, 0.026140, 0.027252, 0.030428, 0.031905, 0.033840, 0.039942, 0.044046, 0.044157, 0.040539
#*# 	0.043158, 0.040203, 0.041404, 0.039617, 0.032701, 0.018392, 0.012437, 0.016209, 0.015434, 0.013932, 0.018137, 0.019420, 0.020949, 0.019592, 0.018189, 0.016662, 0.012442, 0.014983, 0.018641, 0.019154, 0.021467, 0.023212, 0.024178, 0.027198, 0.028404, 0.032252, 0.038426, 0.043101, 0.044100, 0.042512
#*# 	0.039032, 0.037304, 0.035631, 0.036373, 0.027885, 0.012966, 0.004483, 0.005361, 0.007037, 0.009424, 0.013749, 0.015433, 0.018121, 0.016561, 0.012964, 0.009360, 0.006696, 0.011252, 0.013970, 0.014418, 0.017730, 0.019850, 0.018669, 0.021118, 0.024393, 0.028248, 0.034764, 0.039241, 0.041856, 0.038755
#*# 	0.035905, 0.032998, 0.034174, 0.034267, 0.026373, 0.009447, 0.002088, 0.003540, 0.004443, 0.006336, 0.010050, 0.014486, 0.017035, 0.012916, 0.008458, 0.006566, 0.002694, 0.006427, 0.009580, 0.012775, 0.015767, 0.015952, 0.015301, 0.019561, 0.022817, 0.026053, 0.032645, 0.036908, 0.038520, 0.036622
#*# 	0.031280, 0.031182, 0.032746, 0.032116, 0.022439, 0.007758, 0.000158, 0.002703, 0.003801, 0.005511, 0.009300, 0.013507, 0.013528, 0.009585, 0.006134, 0.002532, -0.000432, 0.002703, 0.008200, 0.011129, 0.013867, 0.013927, 0.013879, 0.018671, 0.021931, 0.026016, 0.031791, 0.035848, 0.036616, 0.034668
#*# 	0.027820, 0.029963, 0.033177, 0.030588, 0.020106, 0.005841, 0.000619, 0.001669, 0.004526, 0.006843, 0.009180, 0.010193, 0.009533, 0.005645, 0.002972, 0.000657, -0.003183, 0.001877, 0.006512, 0.009267, 0.011681, 0.014006, 0.014589, 0.019524, 0.023506, 0.027210, 0.032046, 0.033720, 0.033872, 0.033980
#*# 	0.026743, 0.027660, 0.029604, 0.027404, 0.017734, 0.004597, -0.001895, 0.000592, 0.003516, 0.005925, 0.006792, 0.005295, 0.003299, -0.000248, -0.001667, -0.003005, -0.004837, 0.002869, 0.006416, 0.007138, 0.011608, 0.013954, 0.015272, 0.019190, 0.024985, 0.028500, 0.031385, 0.032065, 0.030875, 0.030228
#*# 	0.021871, 0.024224, 0.027975, 0.024935, 0.016184, 0.002962, -0.003202, -0.000236, 0.003750, 0.004826, 0.004835, 0.002645, -0.000515, -0.003589, -0.002670, -0.000830, -0.001266, 0.003549, 0.006822, 0.007403, 0.010236, 0.013958, 0.014899, 0.021781, 0.025336, 0.027103, 0.028866, 0.029788, 0.029922, 0.028545
#*# 	0.018267, 0.021482, 0.023623, 0.021797, 0.013446, 0.001004, -0.004284, -0.000588, 0.000639, 0.000861, 0.002045, -0.000795, -0.004796, -0.005433, -0.000780, 0.004163, 0.004319, 0.008822, 0.010272, 0.010084, 0.012096, 0.014997, 0.018086, 0.023270, 0.028932, 0.027316, 0.028026, 0.029032, 0.030003, 0.029111
#*# 	0.011995, 0.014950, 0.018637, 0.014490, 0.008037, -0.000567, -0.005936, -0.004419, -0.005165, -0.006074, -0.006794, -0.008692, -0.009373, -0.006389, 0.001123, 0.005241, 0.005453, 0.010240, 0.012494, 0.010685, 0.012563, 0.016578, 0.019603, 0.025685, 0.028565, 0.027062, 0.026685, 0.027230, 0.030979, 0.032879
#*# 	0.005271, 0.007072, 0.008161, 0.004485, -0.000081, -0.008206, -0.012076, -0.008424, -0.012236, -0.016247, -0.016422, -0.017013, -0.014522, -0.010705, -0.003074, 0.003174, 0.004530, 0.010412, 0.011656, 0.010150, 0.011543, 0.014100, 0.017747, 0.023126, 0.026191, 0.022948, 0.022302, 0.024744, 0.031142, 0.033082
#*# 	-0.003388, -0.002931, -0.002821, -0.004611, -0.007188, -0.015667, -0.015072, -0.004831, -0.013991, -0.025764, -0.026175, -0.023667, -0.019057, -0.013669, -0.005306, 0.001450, 0.003093, 0.008213, 0.009620, 0.009568, 0.011294, 0.012520, 0.014827, 0.020094, 0.021011, 0.016816, 0.018609, 0.024990, 0.032616, 0.037383
#*# 	-0.008669, -0.012547, -0.011348, -0.010912, -0.014060, -0.018842, -0.016311, -0.005061, -0.016757, -0.030852, -0.030942, -0.027754, -0.023276, -0.016492, -0.006608, 0.000517, 0.000905, 0.007730, 0.011826, 0.011144, 0.012230, 0.012289, 0.014037, 0.017838, 0.017477, 0.014009, 0.017719, 0.024389, 0.034282, 0.039964
#*# 	-0.018163, -0.020861, -0.019861, -0.019435, -0.017711, -0.020763, -0.021087, -0.017213, -0.024005, -0.033556, -0.032558, -0.029967, -0.025819, -0.017275, -0.008514, -0.001281, 0.001638, 0.009203, 0.013784, 0.013970, 0.013594, 0.013940, 0.015181, 0.018350, 0.016471, 0.014666, 0.019036, 0.025747, 0.035121, 0.042115
#*# 	-0.025875, -0.031711, -0.031515, -0.029995, -0.025513, -0.025815, -0.026237, -0.025140, -0.028907, -0.036387, -0.037604, -0.033742, -0.027095, -0.020003, -0.010608, -0.003557, -0.000027, 0.008721, 0.014886, 0.016034, 0.017586, 0.016680, 0.015612, 0.017560, 0.016095, 0.015592, 0.020231, 0.026400, 0.035008, 0.040130
#*# 	-0.033703, -0.040257, -0.041688, -0.037844, -0.031913, -0.031374, -0.031695, -0.028874, -0.032565, -0.039563, -0.039926, -0.034717, -0.027288, -0.021152, -0.007974, -0.002603, -0.001762, 0.007565, 0.015160, 0.018795, 0.019984, 0.019488, 0.017686, 0.019485, 0.018979, 0.018525, 0.022698, 0.028644, 0.036628, 0.043410
#*# 	-0.036198, -0.047030, -0.046924, -0.042818, -0.036994, -0.035238, -0.033012, -0.029755, -0.032600, -0.039514, -0.039410, -0.031871, -0.026252, -0.018048, 0.002318, 0.007922, -0.001667, 0.006596, 0.016763, 0.022886, 0.025249, 0.023527, 0.021707, 0.022940, 0.022816, 0.023804, 0.028530, 0.034867, 0.041345, 0.043799
#*# 	-0.042262, -0.051996, -0.051566, -0.047523, -0.041644, -0.038349, -0.036282, -0.031634, -0.034074, -0.038909, -0.037589, -0.032086, -0.025300, -0.016579, -0.003482, -0.000730, -0.002809, 0.007888, 0.017515, 0.023110, 0.028090, 0.027640, 0.024691, 0.024771, 0.027115, 0.029175, 0.033789, 0.038772, 0.044459, 0.049275
#*# 	-0.044303, -0.055694, -0.055451, -0.052772, -0.045398, -0.041643, -0.039470, -0.033825, -0.036683, -0.037835, -0.037524, -0.033939, -0.024442, -0.016567, -0.007584, -0.004858, -0.002933, 0.007762, 0.017521, 0.024551, 0.030423, 0.030629, 0.025959, 0.028463, 0.032535, 0.035091, 0.041084, 0.045670, 0.050546, 0.054346
#*# 	-0.047205, -0.056991, -0.058108, -0.054552, -0.048026, -0.045520, -0.043579, -0.037746, -0.039214, -0.041036, -0.039852, -0.033066, -0.024224, -0.017961, -0.010692, -0.005056, -0.003037, 0.008928, 0.019221, 0.027093, 0.034194, 0.032517, 0.029399, 0.033486, 0.039724, 0.042233, 0.047605, 0.052282, 0.056985, 0.061991
#*# 	-0.046742, -0.059885, -0.058142, -0.055644, -0.049645, -0.048863, -0.045388, -0.040512, -0.041491, -0.043381, -0.039099, -0.031742, -0.024305, -0.015564, -0.006952, -0.004720, -0.001236, 0.011929, 0.023242, 0.032406, 0.038000, 0.037811, 0.035132, 0.041264, 0.046865, 0.049394, 0.054834, 0.060643, 0.064748, 0.068465
#*# 	-0.053188, -0.061147, -0.060639, -0.058228, -0.053339, -0.052145, -0.049592, -0.045492, -0.044979, -0.043509, -0.038920, -0.032592, -0.024642, -0.015553, -0.007086, -0.004948, 0.000059, 0.015054, 0.028509, 0.034264, 0.042263, 0.040731, 0.039002, 0.044917, 0.052004, 0.055172, 0.060079, 0.063594, 0.069280, 0.076080
#*# 	-0.056007, -0.063601, -0.063975, -0.064122, -0.058283, -0.057023, -0.055640, -0.051763, -0.049167, -0.046835, -0.041664, -0.034803, -0.026413, -0.017331, -0.008084, -0.005064, 0.001034, 0.017480, 0.028971, 0.035517, 0.041375, 0.040062, 0.038219, 0.045195, 0.053680, 0.056424, 0.059780, 0.065483, 0.071845, 0.077652
#*# 	-0.052834, -0.064889, -0.063411, -0.063069, -0.060450, -0.060760, -0.060548, -0.053220, -0.049276, -0.047342, -0.041728, -0.032951, -0.024180, -0.014930, -0.005704, 0.000439, 0.006230, 0.019591, 0.030917, 0.036956, 0.042086, 0.039833, 0.038612, 0.047667, 0.058555, 0.059924, 0.063056, 0.068167, 0.075354, 0.083161
#*# 	-0.051199, -0.062422, -0.059152, -0.057331, -0.057528, -0.059204, -0.060503, -0.053987, -0.049339, -0.045846, -0.037822, -0.029010, -0.020295, -0.011388, -0.001197, 0.006294, 0.010846, 0.024932, 0.034660, 0.038882, 0.040775, 0.038930, 0.039783, 0.050893, 0.059047, 0.062659, 0.067076, 0.072685, 0.079731, 0.085797
#*# 	-0.056929, -0.059941, -0.054510, -0.054563, -0.055040, -0.058931, -0.062627, -0.057175, -0.051418, -0.045532, -0.036238, -0.027739, -0.018436, -0.006871, 0.005982, 0.010149, 0.014875, 0.025174, 0.036431, 0.037576, 0.040680, 0.039367, 0.041814, 0.051122, 0.061303, 0.066686, 0.073929, 0.078192, 0.084892, 0.091700
#*# 	-0.054031, -0.056000, -0.053192, -0.052213, -0.052610, -0.058505, -0.062880, -0.060640, -0.051393, -0.044994, -0.035328, -0.026406, -0.014712, -0.002783, 0.007969, 0.012997, 0.018108, 0.029818, 0.037176, 0.041368, 0.044145, 0.044500, 0.045789, 0.054326, 0.063591, 0.071872, 0.077463, 0.084159, 0.092964, 0.102512
#*# x_count = 30
#*# y_count = 30
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 30.0
#*# max_x = 320.0
#*# min_y = 30.0
#*# max_y = 320.0
#*#
#*# [cartographer touch_model default]
#*# threshold = 800
#*# speed = 2
#*# z_offset = -0.05
#*# software_version = 1.3.3
#*# mcu_version = CARTOGRAPHER 5.0.0
#*#
#*# [cartographer scan_model default]
#*# coefficients = 1.4430697558932748,1.918410698540848,0.858829003117238,0.4187785464086273,0.3694006937192553,0.40807055522337066,-0.11099282295649247,-0.2875861443997705,0.24012476645748665,0.24480783955649252
#*# domain = 3.21766154888239e-07,3.344900775185777e-07
#*# z_offset = 0
#*# reference_temperature = 29.52
#*# software_version = 1.3.3
#*# mcu_version = CARTOGRAPHER 5.0.0
